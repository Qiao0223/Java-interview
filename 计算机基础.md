# 1. 进程调度算法

进程调度算法决定了**CPU 如何在多个进程之间进行切换和分配时间**，主要目标是 **提高 CPU 利用率、减少进程等待时间、保证系统公平性**。

---

## **1️⃣ 进程调度的基本概念**

### **📌 进程调度的三种方式**

1. **非抢占式调度（Non-Preemptive）**
    
    - **CPU 一旦分配给某个进程，进程必须主动释放 CPU**（如 I/O 阻塞、终止）。
    - **适用于批处理系统**，如 **先来先服务（FCFS）、短作业优先（SJF）**。
2. **抢占式调度（Preemptive）**
    
    - **CPU 可随时从正在运行的进程切换到其他进程**。
    - **适用于多任务和实时系统**，如 **时间片轮转（RR）、优先级调度、抢占式 SJF**。
3. **混合调度**
    
    - 结合 **抢占式和非抢占式**，适用于不同场景（如 Linux 调度）。

---

## **2️⃣ 主要进程调度算法**

|**算法**|**抢占性**|**优先级**|**适用场景**|
|---|---|---|---|
|**先来先服务（FCFS）**|❌ 非抢占式|无|批处理系统|
|**短作业优先（SJF）**|✅ 可抢占|低|适用于 CPU 计算密集型任务|
|**最高优先级调度（Priority）**|✅ 可抢占|有|适用于需要优先处理的任务（如实时系统）|
|**时间片轮转（RR）**|✅ 可抢占|无|适用于交互式系统|
|**多级反馈队列（MLFQ）**|✅ 可抢占|有|适用于多任务操作系统|
|**最短剩余时间优先（SRTF）**|✅ 可抢占|低|适用于需要快速响应的小任务|

---

## **3️⃣ 进程调度算法详解**

### **📌 1. 先来先服务（FCFS）**

- **非抢占式调度**，按照进程到达顺序执行。
- **优点**：简单、公平，无饥饿现象。
- **缺点**：可能导致**短任务等待长任务（“短任务饥饿”）**。

---

### **📌 2. 短作业优先（SJF）**

- **按进程运行时间长短排序，短进程优先执行**。
    
- **非抢占式 SJF**：
    
    - 进程一旦获得 CPU，不会被抢占。
- **抢占式 SJF（最短剩余时间优先，SRTF）**：
    
    - 如果有更短的进程到来，会抢占当前进程。
- **优点**：最小化平均等待时间。
    
- **缺点**：长作业可能一直等待（“长任务饥饿”）。
    

---

### **📌 3. 最高优先级调度（Priority）**

- **每个进程分配一个优先级，优先级高的进程先执行**。
    
- **两种方式**：
    
    - **非抢占式**：高优先级进程执行完毕后，低优先级进程才运行。
    - **抢占式**：如果有更高优先级进程到来，会抢占当前进程。
- **缺点**：
    
    - **可能导致“低优先级进程饥饿”**（解决方案：**动态优先级提升**）。
    - **实时系统适用，如任务调度、数据库请求处理**。

---

### **📌 4. 时间片轮转（Round Robin，RR）**

- **抢占式调度，每个进程按时间片（如 100ms）轮流执行**。
    
- **时间片用完后，进程进入就绪队列，等待下一轮调度**。
    
- **优点**：
    
    - 适用于 **交互式系统**（响应快）。
    - 确保所有进程 **公平执行**，不会饿死。
- **缺点**：
    
    - 时间片太小 → **进程频繁切换，系统开销高（上下文切换）**。
    - 时间片太大 → **退化成 FCFS（长任务占用 CPU）**。

---

### **📌 5. 多级反馈队列（MLFQ）**

- **多个优先级队列，进程根据执行情况在队列间动态调整**。
    
- **新进程进入高优先级队列，运行后优先级逐步降低**。
    
- **长时间等待的进程可以动态提升优先级，避免“饥饿”**。
    
- **适用于现代操作系统（如 Linux 调度器 CFS）**：
    
    - **短任务先执行**，提高响应速度。
    - **长任务逐步降低优先级，防止短任务饥饿**。

---

## **4️⃣ 进程调度算法的比较**

|**算法**|**优点**|**缺点**|**适用场景**|
|---|---|---|---|
|**FCFS**|简单、公平|**长任务影响短任务**|**批处理系统**|
|**SJF**|**最小等待时间**|**长任务可能一直等待**|**CPU 密集型任务**|
|**Priority**|**高优先级任务先执行**|**低优先级任务可能饿死**|**实时系统**|
|**RR**|**响应时间快**|**可能导致高频切换（高开销）**|**交互式系统**|
|**MLFQ**|**综合优点，适应性强**|**复杂度高**|**通用操作系统**|

---

## **5️⃣ 现代操作系统使用的调度算法**

|**操作系统**|**使用的调度算法**|
|---|---|
|**Windows**|**基于优先级的抢占式调度**|
|**Linux**|**CFS（完全公平调度），基于 MLFQ**|
|**macOS**|**优先级 + 时间片轮转**|
|**Android**|**Linux CFS + 实时调度**|

---

## **6️⃣ 结论**

- **批处理系统（无交互）适合 FCFS、SJF**。
- **交互式系统（响应时间重要）适合 RR、MLFQ**。
- **实时系统适合 优先级调度（Priority Scheduling）**。
- **现代操作系统使用 MLFQ + CFS（Linux 完全公平调度器）**。